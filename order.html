<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Essensbestellung Spielersitzung</title>
    <link rel="icon" href="favicon.png" type="image/png">
    <style>
        body {
            font-family: sans-serif;
            background-color: #d8e1fa;
            color: #333;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #007bff;
        }
        form {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        label, input, select, textarea {
            display: block;
            width: 100%;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        input, select, textarea {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px;
            border: none;
            cursor: pointer;
        }
        .link-button, .home-button {
            background-color: #555;
        }
        .button-container {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: 10px;
        }
        .button-container button {
            flex: 1;
            padding: 10px;
            white-space: nowrap;
        }
        .link-button, .home-button {
            text-decoration: none;
        }
    </style>
</head>
<body>

    <img src="head.png" alt="Logo TVW" style="width:100%; max-width:600px; display:block; margin:0 auto;">

    <div class="button-container">
        <a href="index.html" class="home-button"><button>Startseite</button></a>
        <a href="uebersicht.html" class="link-button"><button>Bestellübersicht</button></a>
    </div>

    <h1>Essensbestellung aufgeben</h1>

    <form id="bestellformular">
        <label for="name">Dein Name:</label>
        <input type="text" id="name" required>
        
        <label for="gericht">Dein Gericht:</label>
        <select id="gericht" required>
            <option value="">Wähle ein Gericht</option>
            <option value="Gyros mit Pommes und Reis 14,50 EUR">Nr. 50) Gyros mit Pommes und Reis 14,50 EUR</option>
            <option value="Souvlaki mit Pommes und Reis 14,90 EUR">Nr. 53) Souvlaki mit Pommes und Reis 14,90 EUR</option>
            <option value="Schnitzel Wiener Art mit Pommes 13,90 EUR">Nr. 60) Schnitzel Wiener Art mit Pommes 13,90 EUR</option>
            <option value="Kotopoulo Hähnchenfilet mit Pommes und Reis 15,50 EUR">Nr. 56) Kotopoulo Hähnchenfilet mit Pommes und Reis 15,50 EUR</option>
            <option value="Gyros Spezial mit Metaxa Sauce und Käse überbacken 16,90 EUR">Nr. 70) Gyros Spezial mit Metaxa Sauce und Käse überbacken 16,90 EUR</option>
            <option value="Kalamari paniert und frittiert, mit Reis 16,90 EUR">Nr. 81) Kalamari paniert und frittiert, mit Reis 16,90 EUR</option>
            <option value="Choriatiki Bauernsalat mit Tomaten und Gurken 10,90 EUR">Nr. 30) Choriatiki Bauernsalat mit Tomaten und Gurken 10,90 EUR</option>
            <option value="Thunfisch Salat 11,50 EUR">Nr. 8) Thunfisch Salat 11,50 EUR</option>
            <option value="Pommes 3,50 EUR">Nr. 35) Pommes 3,50 EUR</option>
        </select>
        
        <label for="sonderwuensche">Sonderwünsche oder Anmerkungen zum Gericht:</label>
        <textarea id="sonderwuensche"></textarea>
        
        <button type="submit">Bestellung abschicken</button>
    </form>

    <script type="module">
        import { db, auth } from './firebase-config.js';
        import { serverTimestamp, collection, addDoc } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js';

        const bestellformular = document.getElementById("bestellformular");
        const nameInput = document.getElementById("name");
        const gerichtInput = document.getElementById("gericht");
        const sonderwuenscheInput = document.getElementById("sonderwuensche");

        let userUid = null;

        bestellformular.addEventListener("submit", (e) => {
            e.preventDefault();

            const name = nameInput.value;
            const gericht = gerichtInput.value;
            const sonderwuensche = sonderwuenscheInput.value;

            addDoc(collection(db, "bestellungen"), {
                userId: userUid,
                name: name,
                gericht: gericht,
                sonderwuensche: sonderwuensche,
                timestamp: serverTimestamp()
            })
            .then(() => {
                alert("Bestellung erfolgreich gespeichert!");
                bestellformular.reset();
            })
            .catch((error) => {
                console.error("Fehler beim Speichern der Bestellung: ", error);
                alert("Fehler beim Speichern der Bestellung.");
            });
        });

        auth.signInAnonymously().then((userCredential) => {
            userUid = userCredential.user.uid;
            console.log("Benutzer-ID:", userUid);
        }).catch((error) => {
            console.error("Fehler bei der anonymen Anmeldung:", error);
        });
    </script>
</body>
</html>